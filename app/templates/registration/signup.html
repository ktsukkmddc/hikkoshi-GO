{% extends 'base_plain.html' %}
{% load static %}

{% block title %}新規アカウント登録 | 引越しGO{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/signup.css' %}">
{% endblock %}

{% block content %}
<div class="signup-wrapper">
  <h2>新規アカウント登録</h2>

  <form method="post">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="form-group">
      <label for="id_name">名前</label>
      {{ form.name }}
    </div>

    <div class="form-group">
      <label for="id_email">メールアドレス</label>
      {{ form.email }}
    </div>

    <div class="form-group password-field">
      <div class="label-row">
        <label for="id_password1">パスワード</label>
        <button type="button" id="password-rules-btn">？</button>  
      </div>  
      {{ form.password1 }}
    </div>

    <div class="form-group">
      <label for="id_password2">パスワード再入力</label>
      {{ form.password2 }}
    </div>

    <button type="submit" class="btn">登録</button>
  </form>

  <p class="login-link">
      <a href="{% url 'login' %}">すでにアカウントをお持ちの方はこちら</a>
    </p>

    {% include 'partials/password_rules.html' %}
</div>

<script>
  const rulesBtn = document.getElementById('password-rules-btn');
  const rulesBox = document.getElementById('password-rules');

  rulesBtn.addEventListener('click', (e) => {
    e.stopPropagation(); // クリックイベントの伝播を防ぐ
    rulesBox.style.display = (rulesBox.style.display === 'block') ? 'none' : 'block';
    if (rulesBox.style.display === 'block') {
      rulesBox.classList.add('fade-in');
    } else {
      rulesBox.classList.remove('fade-in');
    }
    });

    // 画面のどこかをクリックしたら閉じる
    document.addEventListener('click', (e) => {
      if (rulesBox.style.display === 'block' && !rulesBox.contains(e.target) && e.target !== rulesBtn) {
        rulesBox.style.display = 'none';
      }
    });
  </script>
{% endblock %}